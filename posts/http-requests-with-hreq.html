<!DOCTYPE html>
<html lang="en">
  <head>
      <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-148776727-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-148776727-1');
    </script>
    <title>HTTP Requests with Hreq</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="Lukwago Allan - HTTP Requests with Hreq">
    <meta name="keywords" content="Haskell, Functional progarmming, FP">
    <meta name="author" content="Lukwago Allan" />

    <!-- Twitter cards -->
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@epicallanl" />
    <meta name="twitter:creator" content="@epicallanl" />
    <meta property="twitter:title" content="Lukwago Allan - HTTP Requests with Hreq" />
    <meta name="twitter:description" content="An easy to use type driven Http client Haskell library inspired by Servant-Client." />
    <meta name="twitter:image:src" content="https://lukwagoallan.com/images/favicon_io/android-chrome-192x192.png" />

    <meta property="og:title" content="Lukwago Allan - HTTP Requests with Hreq" />
    <meta property="og:description" content="An easy to use type driven Http client Haskell library inspired by Servant-Client." />
    <meta property="og:site_name" content="Lukwago Allan" />
    <meta property="og:image" content="https://lukwagoallan.com/images/favicon_io/android-chrome-192x192.png" />

    <!-- Favicon -->
    <link rel="shortcut icon" href="../favicon.ico" type="image/x-icon">

    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/styles/dracula.min.css" />
    <!-- Custom fonts for this template -->
    <link href="../css/font-awesome.css" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css">
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Lato" />
    <!-- Custom styles for this template -->
    <link href="../css/default.css" rel="stylesheet">
    <link href="../css/post.css" rel="stylesheet">
  </head>

  <body class="body-posts">

          <!-- Header -->
      <nav class="navbar navbar-inverse navbar-fixed-left leftmenu bg-primary" style="flex-direction: column">

            <div class="toc-zone pt-md-5 d-none d-lg-block">
                <div class="row">
                    <div class="col-md-12">
                        <h5 class="about-text">Contents</h5>
                        <div class="toc pt-md-2" id="main">
                            <ul>
<li><a href="#intro">Intro</a></li>
<li><a href="#motivation">Motivation</a></li>
<li><a href="#comparison-between-hreq-and-servant-client">Comparison between Hreq and Servant client</a></li>
<li><a href="#usage-example">Usage Example</a></li>
<li><a href="#conclusion">Conclusion</a></li>
</ul>
                        </div>
                    </div>
                </div>

            </div>

            <div class="row coolFont pt-md-3 justify-content-center">
                <div class="col-md-12">
                    
                        <span class="tag-block" style="display:inline-block; padding-bottom: 0.2em"> <a class="btn btn-outline-dark btn-tag" href="../tags/Haskell">Haskell</a> </span>
                    
                        <span class="tag-block" style="display:inline-block; padding-bottom: 0.2em"> <a class="btn btn-outline-dark btn-tag" href="../tags/Network">Network</a> </span>
                    
                        <span class="tag-block" style="display:inline-block; padding-bottom: 0.2em"> <a class="btn btn-outline-dark btn-tag" href="../tags/HTTP-Client">HTTP-Client</a> </span>
                    
                        <span class="tag-block" style="display:inline-block; padding-bottom: 0.2em"> <a class="btn btn-outline-dark btn-tag" href="../tags/library">library</a> </span>
                    
                </div>
            </div>

            <div class="pt-md-3 about-text">
                <div class="row justify-content-center pt-md-2">
                    <div class="col-md-12">
                        <h6><a href="../posts"> Posts </a></h6>
                    </div>
                </div>
                <div class="row justify-content-center pt-md-2">
                    <div class="col-md-12">
                        <h6><a href="../"> About me </a></h6>
                    </div>
                </div>

                <div class="row justify-content-center pt-md-2 d-none d-md-block">
                    <div class="col-md-12">
                        <h6 class="text-uppercase">Around the web</h6>
                    </div>
                </div>

                <div class="row justify-content-center pt-md-2 d-none d-md-block">
                    <div class="col-md-12">
                            <ul class="list-inline mb-0 mx-auto">

                                <li class="list-inline-item my-auto">
                                    <a class="btn btn-outline-light btn-social text-center rounded-circle" href="https://github.com/epicallan" target="_blank">
                                    <i class="fa fa-fw fa-github"></i>
                                    </a>
                                </li>

                                <li class="list-inline-item my-auto">
                                    <a class="btn btn-outline-light btn-social text-center rounded-circle" href="https://twitter.com/epicallan" target="_blank">
                                    <i class="fa fa-fw fa-twitter"></i>
                                    </a>
                                </li>

                                <li class="list-inline-item my-auto">
                                    <a class="btn btn-outline-light btn-social text-center rounded-circle" href="https://www.linkedin.com/in/allan-lukwago" target="_blank">
                                        <i class="fa fa-fw fa-linkedin"></i>
                                        </a>
                                <li class="list-inline-item my-auto">


                                </ul>
                    </div>
                </div>
            </div>
      </nav>
      <div class="container info">
          <h2 class="text-center text-uppercase">HTTP Requests with Hreq</h2>
          <div class="content">
          <div class="row post">
              <div class="col-12 post-body">
              <p class="lead">
                  <h2 id="intro">Intro<a href="#intro" class="anchor">ðŸ”—</a></h2>
<p>Hreq is a high-level easy to use type-driven HTTP client library inspired by Servant-Client. Hreq provides an alternative approach to type-safe construction and interpretation of API endpoints for Http client requests.</p>
<p>Hreq should feel very familiar to anyone who has worked with Servant-server or Servant-Client while feeling more lightweight and minimal.</p>
<p>Find library source code in the link below.</p>
<ul>
<li><a href="https://github.com/epicallan/hreq">epicallan/hreq</a></li>
</ul>
<h2 id="motivation">Motivation<a href="#motivation" class="anchor">ðŸ”—</a></h2>
<p>Hreq was motivated by the simplicity and ease of use of <a href="https://github.com/mrkkrp/req">Req</a> and the type-driven elegance of <a href="https://github.com/haskell-servant/servant/tree/master/servant-client">Servant-Client</a>. I envisioned Hreq as the best possible compromise of both worlds.</p>
<p>The Servant client library was first and foremost designed as a solution to generate API client functions for pre-defined Servant server API structures. So it shines when used in that context. However, this doesnâ€™t mean it doesnâ€™t work well in isolation; it certainly does albeit at the cost of some boiler-plate.</p>
<p>Hreq, on the other hand, was designed for a more general-purpose use. Its approach is thus similar to the one found in the Req library or some of the HTTP client libraries in mainstream programming languages. Hreqâ€™s interface is thus more straightforward and less verbose while maintaining good type-level expressiveness and ease of use.</p>
<h2 id="comparison-between-hreq-and-servant-client">Comparison between Hreq and Servant client<a href="#comparison-between-hreq-and-servant-client" class="anchor">ðŸ”—</a></h2>
<p>Hreq shares a lot of similarities and differences with servant client, so itâ€™s imperative I list some of the prominent ones.</p>
<ul>
<li><p>Hreqâ€™s API structures are more Kind restricted, enabling more type correctness and more straightforward formulation of type-level functions. A drawback of this approach is that Hreq is less extensible than servant-client.</p></li>
<li><p>Hreq provides a default HTTP client manager such that one doesnâ€™t have to think about manager configuration. This is in stark contrast with Servant-Client where you have to provide one. Itâ€™s also possible to over-ride the provided default manager.</p></li>
<li><p>Hreq provides type synonyms for common API type combinators, therefore, making API endpoint definitions much shorter for some cases.</p></li>
<li><p>In Hreq API types are used directly within API functions via Type Application. While in servant-client, API endpoint types are used to create API querying functions. API endpoint types hence have a more first-class treatment in Hreq than in Servant client.</p></li>
<li><p>In Servant-client, valid responses must have a status code between 200 and 300. In Hreq one can configure a range for valid status codes via the HTTP config with 200 to 300 as the default.</p></li>
<li><p>In Hreq, API Request component arguments are provided to API functions through a Heterogeneous list. While in Servant client, arguments are provided to newly auto-created API functions.</p></li>
<li><p>Hreq is still a young project, and it doesnâ€™t have a good streaming story yet in comparison to Servant-client.</p></li>
</ul>
<h2 id="usage-example">Usage Example<a href="#usage-example" class="anchor">ðŸ”—</a></h2>
<p>Find more examples in <a href="https://github.com/epicallan/hreq/blob/master/example/Main.hs">this Example module</a> of the project on Github</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">import</span> <span class="dt">Data.Aeson</span> (<span class="dt">FromJSON</span>, <span class="dt">ToJSON</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">import</span> <span class="dt">GHC.Generics</span> (<span class="dt">Generic</span>)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw">import</span> <span class="dt">Network.HTTP.Hreq</span></span>
<span id="cb1-4"><a href="#cb1-4"></a></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="kw">data</span> <span class="dt">User</span> <span class="ot">=</span> <span class="dt">User</span></span>
<span id="cb1-6"><a href="#cb1-6"></a>  {<span class="ot"> name ::</span> <span class="dt">String</span></span>
<span id="cb1-7"><a href="#cb1-7"></a>  ,<span class="ot"> age  ::</span> <span class="dt">Int</span></span>
<span id="cb1-8"><a href="#cb1-8"></a>  } <span class="kw">deriving</span> (<span class="dt">Show</span>, <span class="dt">Generic</span>, <span class="dt">FromJSON</span>, <span class="dt">ToJSON</span>)</span>
<span id="cb1-9"><a href="#cb1-9"></a></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="ot">main ::</span> <span class="dt">IO</span> ()</span>
<span id="cb1-11"><a href="#cb1-11"></a>main <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb1-12"><a href="#cb1-12"></a>  res <span class="ot">&lt;-</span> runHreq baseUrl <span class="op">$</span> <span class="kw">do</span></span>
<span id="cb1-13"><a href="#cb1-13"></a>    createdUser <span class="ot">&lt;-</span> createUser newUser</span>
<span id="cb1-14"><a href="#cb1-14"></a>    myUser      <span class="ot">&lt;-</span> getUserByName <span class="st">&quot;allan&quot;</span></span>
<span id="cb1-15"><a href="#cb1-15"></a>    allUsers    <span class="ot">&lt;-</span> hreq <span class="op">@</span>(<span class="dt">GetJson</span> [<span class="dt">User</span>]) <span class="dt">Empty</span></span>
<span id="cb1-16"><a href="#cb1-16"></a>    <span class="fu">return</span> (createdUser, myUser, allUsers)</span>
<span id="cb1-17"><a href="#cb1-17"></a>  <span class="fu">print</span> res</span>
<span id="cb1-18"><a href="#cb1-18"></a>  <span class="kw">where</span></span>
<span id="cb1-19"><a href="#cb1-19"></a><span class="ot">    baseUrl ::</span> <span class="dt">BaseUrl</span></span>
<span id="cb1-20"><a href="#cb1-20"></a>    baseUrl <span class="ot">=</span> <span class="dt">BaseUrl</span> <span class="dt">Http</span> <span class="st">&quot;example.com&quot;</span> <span class="dv">80</span> <span class="st">&quot;user&quot;</span></span>
<span id="cb1-21"><a href="#cb1-21"></a></span>
<span id="cb1-22"><a href="#cb1-22"></a><span class="ot">    newUser ::</span> <span class="dt">User</span></span>
<span id="cb1-23"><a href="#cb1-23"></a>    newUser <span class="ot">=</span> <span class="dt">User</span> <span class="st">&quot;Allan&quot;</span> <span class="dv">29</span></span>
<span id="cb1-24"><a href="#cb1-24"></a></span>
<span id="cb1-25"><a href="#cb1-25"></a><span class="ot">createUser ::</span> <span class="dt">RunHttp</span> m <span class="ot">=&gt;</span> <span class="dt">User</span> <span class="ot">-&gt;</span> m <span class="dt">User</span></span>
<span id="cb1-26"><a href="#cb1-26"></a>createUser user <span class="ot">=</span> hreq <span class="op">@</span>(<span class="dt">JsonBody</span> <span class="dt">User</span> <span class="op">:&gt;</span> <span class="dt">PostJson</span> <span class="dt">User</span>) (user <span class="op">:.</span> <span class="dt">Empty</span>)</span>
<span id="cb1-27"><a href="#cb1-27"></a></span>
<span id="cb1-28"><a href="#cb1-28"></a><span class="ot">getUserByName ::</span> <span class="dt">RunHttp</span> m <span class="ot">=&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> m <span class="dt">User</span></span>
<span id="cb1-29"><a href="#cb1-29"></a>getUserByName userName <span class="ot">=</span> hreq <span class="op">@</span>(<span class="dt">Capture</span> <span class="dt">String</span> <span class="op">:&gt;</span> <span class="dt">GetJson</span> <span class="dt">User</span>) (userName  <span class="op">:.</span> <span class="dt">Empty</span>)</span></code></pre></div>
<h2 id="conclusion">Conclusion<a href="#conclusion" class="anchor">ðŸ”—</a></h2>
<p>I hope you get to enjoy hreq. Please reach out through the <a href="https://github.com/epicallan/hreq">projectâ€™s github issue tracker</a> if you come across any issues. Happy coding.</p>
                </p>
                <br>
                <p>Published on: November  6, 2019</p>
                <br>
                <p>
                    My blog is hosted on <a href="https://github.com/epicallan/epicallan.github.io" target="_blank">Github</a>. If you would like to leave a comment or report a problem please feel free to
                    leave one there.
                </p>
              </div>
          </div>
          </div>
      </div>


      <!-- Bootstrap core JavaScript -->
      <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"> </script>
      <script src="../js/post.js"> </script>
      <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/haskell.min.js"></script>
      <script>hljs.initHighlightingOnLoad()</script>
      <script async defer src="https://buttons.github.io/buttons.js"></script>
  </body>
</html>
